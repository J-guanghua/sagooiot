import{d as e,h as l,a1 as a,R as t,S as d,j as o,n as u,ah as s,o as p,b as n,Y as i,W as r,a as m,F as c,a7 as v,e as f,a8 as y}from"./vue.1709105786614.js";import{b,E as h}from"./index.1709105786614.js";import{r as V}from"./validator.1709105786614.js";import{a as _}from"./index.17091057866148.js";const g={"class":"dialog-footer"},k=e({__name:"edit",emits:["getList"],setup(e,{expose:k,emit:I}){const U=I,{proxy:w}=o(),{api_types:S}=w.useDict("api_types"),T=l(!1),x=l(),O=l([]),j=l([]),J=l([]),N={menuIds:[],id:void 0,parentId:void 0,name:"",types:2,apiTypes:"",address:"",method:"",remark:"",status:1},D=a(JSON.parse(JSON.stringify(N)));function L(){D.parentId=void 0}const C={parentId:[V("上级分类不能为空","change")],method:[V("请求方式不能为空","change")],apiTypes:[V("接口类型不能为空","change")],name:[V("名称不能为空","change")],address:[V("接口地址不能为空")]};_.template.getDictData({DictType:"api_methods"}).then((e=>{J.value=e.values})),b.menu.getList({status:-1}).then((e=>{O.value=e}));const P=async()=>{await x.value.validate();const e=D.id?b.api.edit:b.api.add;await e(D),h.success("操作成功"),F(),T.value=!1,U("getList")},F=async()=>{D.types,Object.assign(D,{...JSON.parse(JSON.stringify(N))}),x.value&&x.value.resetFields(D)},R=async()=>{F(),T.value=!1};return k({open:async e=>{F(),T.value=!0,b.api.getList({types:1,status:-1}).then((e=>{j.value=e.Info})),u((()=>{Object.assign(D,{method:J.value.length?J.value[0].value:"",...JSON.parse(JSON.stringify(e))})}))}}),(e,l)=>{const a=s("el-radio-button"),o=s("el-radio-group"),u=s("el-form-item"),b=s("el-cascader"),h=s("el-option"),V=s("el-select"),_=s("el-input"),k=s("el-switch"),I=s("el-form"),U=s("el-button"),w=s("el-dialog");return p(),t(w,{"class":"api-edit",modelValue:T.value,"onUpdate:modelValue":l[12]||(l[12]=e=>T.value=e),title:""+(D.id?"编辑接口":"新增接口"),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:d((()=>[n("div",g,[i(U,{onClick:R},{"default":d((()=>[r("取消")])),_:1}),i(U,{type:"primary",onClick:P},{"default":d((()=>[r("确定")])),_:1})])])),"default":d((()=>[i(I,{ref_key:"formRef",ref:x,model:D,rules:C,"label-width":"80px",onKeyup:y(P,["enter"])},{"default":d((()=>[i(u,{label:"选择类型",prop:"types"},{"default":d((()=>[i(o,{modelValue:D.types,"onUpdate:modelValue":l[0]||(l[0]=e=>D.types=e),onChange:L},{"default":d((()=>[i(a,{label:2},{"default":d((()=>[r("接口")])),_:1}),i(a,{label:1},{"default":d((()=>[r("分类")])),_:1})])),_:1},8,["modelValue"])])),_:1}),1===D.types?(p(),m(c,{key:0},[i(u,{label:"上级分类",prop:"parentId"},{"default":d((()=>[i(b,{options:[{id:-1,name:"根节点",children:j.value}],props:{checkStrictly:!0,multiple:!1,emitPath:!1,value:"id",label:"name"},placeholder:"请选择关联页面",clearable:"","class":"w100",modelValue:D.parentId,"onUpdate:modelValue":l[1]||(l[1]=e=>D.parentId=e)},null,8,["options","modelValue"])])),_:1}),i(u,{label:"接口类型",prop:"apiTypes"},{"default":d((()=>[i(V,{modelValue:D.apiTypes,"onUpdate:modelValue":l[2]||(l[2]=e=>D.apiTypes=e),filterable:"",clearable:"",placeholder:"请选择接口类型",style:{width:"100%"}},{"default":d((()=>[(p(!0),m(c,null,v(f(S),(e=>(p(),t(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(u,{label:"分类名称",prop:"name"},{"default":d((()=>[i(_,{modelValue:D.name,"onUpdate:modelValue":l[3]||(l[3]=e=>D.name=e),placeholder:"输入分类名称"},null,8,["modelValue"])])),_:1})],64)):(p(),m(c,{key:1},[i(u,{label:"上级分类",prop:"parentId"},{"default":d((()=>[i(b,{options:[{id:-1,name:"根节点",children:j.value}],props:{checkStrictly:!0,multiple:!1,emitPath:!1,value:"id",label:"name"},placeholder:"请选择关联页面",clearable:"","class":"w100",modelValue:D.parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>D.parentId=e)},null,8,["options","modelValue"])])),_:1}),i(u,{label:"关联页面",prop:"menuIds"},{"default":d((()=>[i(b,{options:O.value,props:{checkStrictly:!0,multiple:!0,emitPath:!1,value:"id",label:"title"},placeholder:"请选择关联页面",filterable:"",clearable:"","class":"w100",modelValue:D.menuIds,"onUpdate:modelValue":l[5]||(l[5]=e=>D.menuIds=e)},null,8,["options","modelValue"])])),_:1}),i(u,{label:"接口名称",prop:"name"},{"default":d((()=>[i(_,{modelValue:D.name,"onUpdate:modelValue":l[6]||(l[6]=e=>D.name=e),placeholder:"输入接口名称"},null,8,["modelValue"])])),_:1}),i(u,{label:"接口地址",prop:"address"},{"default":d((()=>[i(_,{modelValue:D.address,"onUpdate:modelValue":l[7]||(l[7]=e=>D.address=e),placeholder:"接口地址"},null,8,["modelValue"])])),_:1}),i(u,{label:"接口类型",prop:"apiTypes"},{"default":d((()=>[i(V,{modelValue:D.apiTypes,"onUpdate:modelValue":l[8]||(l[8]=e=>D.apiTypes=e),filterable:"",clearable:"",placeholder:"请选择接口类型",style:{width:"100%"}},{"default":d((()=>[(p(!0),m(c,null,v(f(S),(e=>(p(),t(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(u,{label:"访问类型",prop:"method"},{"default":d((()=>[i(V,{modelValue:D.method,"onUpdate:modelValue":l[9]||(l[9]=e=>D.method=e),placeholder:"请选择访问类型"},{"default":d((()=>[(p(!0),m(c,null,v(J.value,(e=>(p(),t(h,{key:e.value,label:e.key,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})],64)),i(u,{label:"状态",prop:"status"},{"default":d((()=>[i(k,{modelValue:D.status,"onUpdate:modelValue":l[10]||(l[10]=e=>D.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),i(u,{label:"备注",prop:"remark"},{"default":d((()=>[i(_,{modelValue:D.remark,"onUpdate:modelValue":l[11]||(l[11]=e=>D.remark=e),type:"textarea",rows:3},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])}}});export{k as default};