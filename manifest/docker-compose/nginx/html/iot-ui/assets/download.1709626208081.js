import{o as e,E as t}from"./index.1709626208081.js";var n={exports:{}},o=n.exports=function i(e,t,n){var o,a,r=window,s="application/octet-stream",d=n||s,c=e,l=!t&&!n&&c,p=document.createElement("a"),u=function(e){return String(e)},f=r.Blob||r.MozBlob||r.WebKitBlob||u,m=t||"download";if(f=f.call?f.bind(r):Blob,"true"===String(this)&&(d=(c=[c,d])[0],c=c[1]),l&&l.length<2048&&(m=l.split("/").pop().split("?")[0],p.href=l,-1!==p.href.indexOf(l))){var h=new XMLHttpRequest;return h.open("GET",l,!0),h.responseType="blob",h.onload=function(e){i(e.target.response,m,s)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&f!==u))return navigator.msSaveBlob?navigator.msSaveBlob(v(c),m):y(c);d=(c=v(c)).type||s}else if(/([\x80-\xff])/.test(c)){for(var b=0,w=new Uint8Array(c.length),g=w.length;b<g;++b)w[b]=c.charCodeAt(b);c=new f([w],{type:d})}function v(e){for(var t=e.split(/[:;,]/),n=t[1],o=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),a=o.length,r=0,i=new Uint8Array(a);r<a;++r)i[r]=o.charCodeAt(r);return new f([i],{type:n})}function y(e,t){if("download"in p)return p.href=e,p.setAttribute("download",m),p.className="download-js-link",p.innerHTML="downloading...",p.style.display="none",document.body.appendChild(p),setTimeout((function(){p.click(),document.body.removeChild(p),!0===t&&setTimeout((function(){r.URL.revokeObjectURL(p.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=c instanceof f?c:new f([c],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(o,m);if(r.URL)y(r.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===u)try{return y("data:"+d+";base64,"+r.btoa(o))}catch(A){return y("data:"+d+","+encodeURIComponent(o))}(a=new FileReader).onload=function(e){y(this.result)},a.readAsDataURL(o)}return!0};const a=(e,n="导出日志.xlsx")=>{const o=new TextDecoder("utf-8").decode(e.data);try{const a=JSON.parse(o);a.message?(t.closeAll(),t.error(a.message)):r(e,n)}catch{r(e,n)}};function r(e,t){const n=e.headers["content-disposition"]?e.headers["content-disposition"].split(",")[0].replaceAll('attachment; filename="',"").replaceAll('"',""):t;o(e.data,n,e.headers["content-type"])}export{a as d};