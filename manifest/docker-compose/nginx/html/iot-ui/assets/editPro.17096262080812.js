import{a as e}from"./index.170962620808122.js";import{u as a}from"./index.170962620808113.js";import{_ as l,g as o,E as t}from"./index.1709626208081.js";import{d as r,h as d,a1 as s,aa as u,a as m,Y as p,S as i,e as n,ah as c,o as g,b as f,W as b,X as h,V as y,F as V,a7 as F,R as _}from"./vue.1709626208081.js";const v=r({name:"deviceEditPro",components:{uploadVue:a},setup(a,{emit:l}){const r=d(null),m=o("/base-api/api/v1"),p=s({isShowDialog:!1,cateData:[],deptData:[],messageData:[],tranData:[],imageUrl:"",singleImg:m+"/product/icon/upload",ruleForm:{id:0,name:"",categoryId:"",deptId:"",messageProtocol:"",transportProtocol:"",deviceType:"设备",status:1,desc:""},rules:{name:[{required:!0,message:"产品名称不能为空",trigger:"blur"}],key:[{required:!0,message:"产品标识不能为空",trigger:"blur"}],parentId:[{required:!0,message:"产品分类不能为空",trigger:"blur"}],deptId:[{required:!0,message:"所属组织不能为空",trigger:"blur"}],messageProtocol:[{required:!0,message:"消息协议不能为空",trigger:"blur"}],transportProtocol:[{required:!0,message:"接入方式不能为空",trigger:"blur"}],deviceType:[{required:!0,message:"设备类型不能为空",trigger:"blur"}]}}),i=()=>{p.ruleForm={id:0,name:"",dictType:"",status:1,desc:""}},c=()=>{p.isShowDialog=!1};return{openDialog:a=>{i(),e.category.getList({status:1}).then((e=>{p.cateData=e.category||[]})),e.dept.getList({status:-1}).then((e=>{p.deptData=e||[]})),e.product.message_protocol_list({status:-1}).then((e=>{p.messageData=e.data||[]})),e.product.trunsport_protocol_list({status:-1}).then((e=>{p.tranData=e.data||[]})),a&&(p.ruleForm=a),p.isShowDialog=!0},handleAvatarSuccess:e=>{p.imageUrl=e,p.ruleForm.imageUrl=e},closeDialog:c,onCancel:()=>{c()},onSubmit:()=>{const a=n(r);a&&a.validate((a=>{a&&(0!==p.ruleForm.id?e.product.edit(p.ruleForm).then((()=>{t.success("产品类型修改成功"),c(),l("typeList")})):e.product.add(p.ruleForm).then((()=>{t.success("产品类型添加成功"),c(),l("typeList")})))}))},formRef:r,...u(p)}}}),D={"class":"system-edit-dic-container"},k={key:0},I={key:0},S={"class":"dialog-footer"};var P=l(v,[["render",function(e,a,l,o,t,r){const d=c("el-input"),s=c("el-form-item"),u=c("uploadVue"),n=c("el-cascader"),v=c("el-option"),P=c("el-select"),U=c("el-radio"),w=c("el-radio-group"),q=c("el-form"),x=c("el-button"),C=c("el-dialog");return g(),m("div",D,[p(C,{title:(0!==e.ruleForm.id?"修改":"添加")+"产品",modelValue:e.isShowDialog,"onUpdate:modelValue":a[8]||(a[8]=a=>e.isShowDialog=a),width:"769px"},{footer:i((()=>[f("span",S,[p(x,{onClick:e.onCancel},{"default":i((()=>[b("取 消")])),_:1},8,["onClick"]),p(x,{type:"primary",onClick:e.onSubmit},{"default":i((()=>[b(h(0!==e.ruleForm.id?"修 改":"添 加"),1)])),_:1},8,["onClick"])])])),"default":i((()=>[p(q,{model:e.ruleForm,ref:"formRef",rules:e.rules,"label-width":"90px"},{"default":i((()=>[p(s,{label:"产品标识",prop:"key"},{"default":i((()=>[p(d,{modelValue:e.ruleForm.key,"onUpdate:modelValue":a[0]||(a[0]=a=>e.ruleForm.key=a),placeholder:"请输入产品标识"},null,8,["modelValue"])])),_:1}),p(s,{label:"产品名称",prop:"name"},{"default":i((()=>[p(d,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.ruleForm.name=a),placeholder:"请输入产品名称"},null,8,["modelValue"])])),_:1}),p(s,{label:"产品图片",prop:"imageUrl"},{"default":i((()=>[p(u,{onSetImg:e.handleAvatarSuccess},null,8,["onSetImg"])])),_:1}),p(s,{label:"产品分类",prop:"categoryId"},{"default":i((()=>[p(n,{options:e.cateData,props:{checkStrictly:!0,emitPath:!1,value:"id",label:"name"},placeholder:"请选择分类",clearable:"","class":"w100",modelValue:e.ruleForm.categoryId,"onUpdate:modelValue":a[2]||(a[2]=a=>e.ruleForm.categoryId=a)},{"default":i((({node:e,data:a})=>[f("span",null,h(a.name),1),e.isLeaf?y("",!0):(g(),m("span",k," ("+h(a.children.length)+") ",1))])),_:1},8,["options","modelValue"])])),_:1}),p(s,{label:"所属组织",prop:"deptId"},{"default":i((()=>[p(n,{options:e.deptData,props:{checkStrictly:!0,emitPath:!1,value:"deptId",label:"deptName"},placeholder:"请选择所属组织",clearable:"","class":"w100",modelValue:e.ruleForm.deptId,"onUpdate:modelValue":a[3]||(a[3]=a=>e.ruleForm.deptId=a)},{"default":i((({node:e,data:a})=>[f("span",null,h(a.deptName),1),e.isLeaf?y("",!0):(g(),m("span",I," ("+h(a.children.length)+") ",1))])),_:1},8,["options","modelValue"])])),_:1}),p(s,{label:"消息协议",prop:"messageProtocol"},{"default":i((()=>[p(P,{modelValue:e.ruleForm.messageProtocol,"onUpdate:modelValue":a[4]||(a[4]=a=>e.ruleForm.messageProtocol=a),placeholder:"请选择消息协议"},{"default":i((()=>[(g(!0),m(V,null,F(e.messageData,(e=>(g(),_(v,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(s,{label:"接入方式",prop:"transportProtocol"},{"default":i((()=>[p(P,{modelValue:e.ruleForm.transportProtocol,"onUpdate:modelValue":a[5]||(a[5]=a=>e.ruleForm.transportProtocol=a),placeholder:"请选择接入方式"},{"default":i((()=>[(g(!0),m(V,null,F(e.tranData,(e=>(g(),_(v,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(s,{label:"设备类型",prop:"deviceType"},{"default":i((()=>[p(w,{modelValue:e.ruleForm.deviceType,"onUpdate:modelValue":a[6]||(a[6]=a=>e.ruleForm.deviceType=a),"model-value":"设备"},{"default":i((()=>[p(U,{label:"设备"},{"default":i((()=>[b("设备")])),_:1}),p(U,{label:"网关"},{"default":i((()=>[b("网关")])),_:1})])),_:1},8,["modelValue"])])),_:1}),p(s,{label:"产品描述\t",prop:"desc"},{"default":i((()=>[p(d,{modelValue:e.ruleForm.desc,"onUpdate:modelValue":a[7]||(a[7]=a=>e.ruleForm.desc=a),type:"textarea",placeholder:"请输入产品描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}],["__scopeId","data-v-61e1f0da"]]);export{P as default};