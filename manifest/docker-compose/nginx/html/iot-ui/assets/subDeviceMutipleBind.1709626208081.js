import{d as e,a1 as a,aa as t,a as l,Y as o,S as i,aC as r,ah as d,ar as n,o as s,F as u,a7 as p,R as m,T as c,W as g,V as y,Z as b}from"./vue.1709626208081.js";/* empty css                     */import{a as h}from"./index.170962620808122.js";import{_ as f,E as w,h as D}from"./index.1709626208081.js";const K=e({name:"MutipleBindDialog",setup(e,{emit:l}){r();const o=a({gatewayKey:"",deviceKeyList:[],isShowDialog:!1,productData:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,productKey:0,status:"",dateRange:[]}},ruleForm:{productKey:""},rules:{productKey:[{required:!0,message:"所属产品不能为空",trigger:"blur"}]}}),i=()=>{if(!o.ruleForm.productKey)return o.tableData.data=[],void(o.tableData.total=0);o.tableData.loading=!0,h.device.getSubList({productKey:o.ruleForm.productKey,pageSize:o.tableData.param.pageSize,pageNum:o.tableData.param.pageNum}).then((e=>{o.tableData.data=e.device,o.tableData.total=e.Total}))["finally"]((()=>o.tableData.loading=!1))},d=()=>{h.product.getSubList().then((e=>{o.productData=e.product,o.ruleForm.productKey=e.product[0].key,i(),o.isShowDialog=!0}))};return{openDialog:e=>{o.gatewayKey=e,d()},getProductList:d,confirmBind:()=>{0!==o.deviceKeyList.length?D.confirm("是否进行批量绑定？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{h.device.mutipleBind({gatewayKey:o.gatewayKey,subKeys:o.deviceKeyList}).then((()=>{w.success("绑定成功"),l("bindSuccess"),o.isShowDialog=!1}))})):w.error("请选择要批量绑定的数据。")},getDeviceList:i,handleSelectionChange:e=>{o.deviceKeyList=e.map((e=>e.key))},handleChange:e=>{o.ruleForm.productKey=e,i()},...t(o)}}}),v={"class":"mutiple-bind-dialog-wrap"};var S=f(K,[["render",function(e,a,t,r,h,f){const w=d("el-option"),D=d("el-select"),K=d("el-button"),S=d("el-form-item"),k=d("el-form"),_=d("el-table-column"),x=d("copy"),C=d("el-tag"),L=d("el-table"),z=d("pagination"),F=d("el-dialog"),B=n("auth"),N=n("col"),V=n("loading");return s(),l("div",v,[o(F,{title:"批量绑定子设备",modelValue:e.isShowDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.isShowDialog=a),width:"90%"},{"default":i((()=>[o(k,{model:e.ruleForm,ref:"formRef",rules:e.rules,size:"small","label-width":"110px"},{"default":i((()=>[o(S,{label:"所属产品",prop:"productKey"},{"default":i((()=>[o(D,{onChange:e.handleChange,modelValue:e.ruleForm.productKey,"onUpdate:modelValue":a[0]||(a[0]=a=>e.ruleForm.productKey=a),placeholder:"请选择所属产品",style:{width:"300px"}},{"default":i((()=>[(s(!0),l(u,null,p(e.productData,(e=>(s(),m(w,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue"]),c((s(),m(K,{style:{"margin-left":"20px"},disabled:!e.deviceKeyList.length,type:"primary",onClick:a[1]||(a[1]=a=>e.confirmBind())},{"default":i((()=>[g("批量绑定")])),_:1},8,["disabled"])),[[B,"mutipleBind"]])])),_:1})])),_:1},8,["model","rules"]),c((s(),m(L,{data:e.tableData.data,style:{width:"100%"},onSelectionChange:e.handleSelectionChange},{"default":i((()=>[o(_,{type:"selection",width:"55",align:"center"}),c((s(),m(_,{label:"标识",prop:"key",width:"130","show-overflow-tooltip":""},{"default":i((({row:e})=>[o(x,{text:e.key},null,8,["text"])])),_:1})),[[N,"key"]]),c(o(_,{label:"设备名称",prop:"name","show-overflow-tooltip":""},null,512),[[N,"name"]]),c(o(_,{label:"产品名称",prop:"productName","show-overflow-tooltip":""},null,512),[[N,"productName"]]),c((s(),m(_,{prop:"status",label:"状态",width:"100",align:"center"},{"default":i((e=>[1==e.row.status?(s(),m(C,{key:0,type:"info",size:"small"},{"default":i((()=>[g("离线")])),_:1})):y("",!0),2==e.row.status?(s(),m(C,{key:1,type:"success",size:"small"},{"default":i((()=>[g("在线")])),_:1})):y("",!0),0==e.row.status?(s(),m(C,{key:2,type:"info",size:"small"},{"default":i((()=>[g("未启用")])),_:1})):y("",!0)])),_:1})),[[N,"status"]]),c(o(_,{prop:"registryTime",label:"激活时间",align:"center",width:"150"},null,512),[[N,"registryTime"]]),c(o(_,{prop:"desc",label:"说明"},null,512),[[N,"desc"]])])),_:1},8,["data","onSelectionChange"])),[[V,e.tableData.loading]]),c(o(z,{total:e.tableData.total,page:e.tableData.param.pageNum,"onUpdate:page":a[2]||(a[2]=a=>e.tableData.param.pageNum=a),limit:e.tableData.param.pageSize,"onUpdate:limit":a[3]||(a[3]=a=>e.tableData.param.pageSize=a),onPagination:e.getDeviceList},null,8,["total","page","limit","onPagination"]),[[b,e.tableData.total>0]])])),_:1},8,["modelValue"])])}]]);export{S as default};