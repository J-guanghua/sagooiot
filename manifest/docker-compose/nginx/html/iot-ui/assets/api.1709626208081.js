import e from"./list-form.1709626208081.js";import{b as a,h as l,E as t}from"./index.1709626208081.js";import i from"./bind.17096262080812.js";import{d as o,h as s,a as n,Y as r,S as d,F as u,ah as p,o as m,b as c,W as f}from"./vue.1709626208081.js";import"./validator.1709626208081.js";const v={"class":"p-3"},h=o({__name:"api",setup(o,{expose:h}){const w=s("接口权限"),b=s(!1),y=s([]),x=s(),_=s(),g=s(),k=async()=>{y.value=[];let e=await a.menu.api.getList({menuId:x.value.id,status:-1});y.value=e||[]},j=()=>{_.value.open(y.value.map((e=>e.id)),x.value.id)};return h({open:async e=>{w.value="接口权限 - "+e.title,b.value=!0,x.value=e,k()}}),(o,s)=>{const h=p("ele-FolderAdd"),C=p("el-icon"),F=p("el-button"),I=p("el-table-column"),L=p("el-table"),V=p("el-drawer");return m(),n(u,null,[r(V,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=e=>b.value=e),title:w.value,direction:"rtl",size:"700px"},{"default":d((()=>[c("div",v,[r(F,{type:"success","class":"mr-3",onClick:j},{"default":d((()=>[r(C,null,{"default":d((()=>[r(h)])),_:1}),f(" 绑定接口 ")])),_:1})]),r(L,{data:y.value,style:{width:"100%"},"max-height":"calc(100vh - 140px)","row-key":"id",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}},{"default":d((()=>[r(I,{type:"index",label:"序号",width:"60",align:"center"}),r(I,{prop:"method",label:"方法",width:"70",align:"center"}),r(I,{prop:"name",label:"名称","show-overflow-tooltip":""}),r(I,{prop:"address",label:"地址","show-overflow-tooltip":""}),r(I,{label:"操作",width:"100",align:"center"},{"default":d((e=>[r(F,{size:"small",text:"",type:"danger",onClick:i=>{return o=e.row,void l.confirm(`此操作将删除接口：“${o.name}”，是否继续?`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{await a.menu.api.add({menuId:x.value.id,apiIds:y.value.map((e=>e.id)).filter((e=>e!==o.id))}),t.success("删除成功"),k()}));var o}},{"default":d((()=>[f("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue","title"]),r(e,{ref_key:"listFormRef",ref:g,onGetList:k},null,512),r(i,{ref_key:"bindRef",ref:_,onGetList:k},null,512)],64)}}});export{h as default};