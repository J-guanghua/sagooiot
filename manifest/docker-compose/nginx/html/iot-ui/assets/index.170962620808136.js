import{d as e,h as l,k as a,a as t,Y as o,S as i,a8 as n,b as d,e as s,ah as r,ar as u,o as c,W as p,T as f,R as m,V as y,X as v}from"./vue.1709626208081.js";import{a as h}from"./index.170962620808122.js";import{u as g}from"./useCommon.1709626208081.js";import{_,M as w,h as k,E as b}from"./index.1709626208081.js";import x from"./edit.17096262080818.js";import"./from.1709626208081.js";import"./validator.1709626208081.js";const C={"class":"page page-full border bg padding"},N={"class":"page page-full-part flex-row gap-4"},j={"class":"custom-tree-node"},T={"class":"tree-label"},S={"class":"page page-full"};var K=_(e({__name:"index",setup(e){const _={children:"children",label:"label"},K=l(),L=l([]),W=l(),z=l(),B=l(),V=l(),I=l([]),{params:R,tableData:U,getList:D,loading:E}=g(h.dev_asset.getList,"Data",{keyWord:""});D();const F=e=>{I.value=e.map((e=>e.id))};a((()=>{q()}));const Y=async e=>{e?B.value.open(e,V.value):B.value.open({},V.value)},q=()=>{h.category.getList({}).then((e=>{z.value=e.category,h.product.getLists({}).then((e=>{L.value=e.product,W.value=G(L.value,z.value),L.value.length>0&&A(W.value[0].children[0])}))}))},A=e=>{"2"===e.is_type?(V.value=e,R.productKey=e.key,D()):V.value=""},G=(e,l)=>{const a=[];for(let t of l){const l=M(t,e);a.push(l)}return a},M=(e,l)=>{const a={id:e.id,label:e.name,key:e.key,is_type:"1",children:[]};if(e.children&&e.children.length>0)for(let t of e.children){const e=M(t,l);a.children.push(e)}else{const t=l.filter((l=>l.categoryId===e.id));for(let e of t){const l={id:e.id,label:e.name,key:e.key,is_type:"2"};a.children.push(l)}}return a};return(e,l)=>{const a=r("el-input"),g=r("el-form-item"),L=r("ele-Search"),z=r("el-icon"),q=r("el-button"),G=r("ele-FolderAdd"),M=r("el-form"),P=r("SvgIcon"),X=r("el-tree"),H=r("el-card"),J=r("el-table-column"),O=r("el-table"),Q=r("pagination"),Z=u("auth"),$=u("col"),ee=u("loading");return c(),t("div",C,[o(M,{inline:"",ref_key:"queryRef",ref:K,onKeyup:l[4]||(l[4]=n((e=>s(D)(1)),["enter"]))},{"default":i((()=>[o(g,{label:"名称",prop:"keyWord"},{"default":i((()=>[o(a,{modelValue:s(R).keyWord,"onUpdate:modelValue":l[0]||(l[0]=e=>s(R).keyWord=e),placeholder:"请输入名称",clearable:"",style:{width:"240px"}},null,8,["modelValue"])])),_:1}),o(g,null,{"default":i((()=>[o(q,{type:"primary","class":"ml10",onClick:l[1]||(l[1]=e=>s(D)(1))},{"default":i((()=>[o(z,null,{"default":i((()=>[o(L)])),_:1}),p(" 查询 ")])),_:1})])),_:1}),o(g,null,{"default":i((()=>[V.value?f((c(),m(q,{key:0,type:"primary",onClick:l[2]||(l[2]=e=>Y())},{"default":i((()=>[o(z,null,{"default":i((()=>[o(G)])),_:1}),p(" 新增档案 ")])),_:1})),[[Z,"add"]]):y("",!0),f((c(),m(q,{type:"info",onClick:l[3]||(l[3]=e=>{k.confirm("是否确认要批量删除这些数据吗?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{await h.dev_asset["delete"]({ids:I.value}),b.success("删除成功"),D()}))})},{"default":i((()=>[o(z,null,{"default":i((()=>[o(G)])),_:1}),p(" 删除 ")])),_:1})),[[Z,"batchdel"]])])),_:1})])),_:1},512),d("div",N,[o(H,{style:{width:"250px"},shadow:"nover"},{"default":i((()=>[o(X,{data:W.value,props:_,accordion:"","default-expand-all":"",onNodeClick:A,"node-key":"id","highlight-current":""},{"default":i((({node:e,data:l})=>[d("div",j,[d("span",T,["2"!=l.is_type?(c(),m(z,{key:0},{"default":i((()=>[o(s(w))])),_:1})):y("",!0),"2"==l.is_type?(c(),m(P,{key:1,name:"iconfont icon-siweidaotu"})):y("",!0),p(" "+v(e.label),1)])])])),_:1},8,["data"])])),_:1}),o(H,{"class":"flex1",shadow:"nover"},{"default":i((()=>[d("div",S,[f((c(),m(O,{data:s(U),style:{width:"100%"},onSelectionChange:F,"row-key":"id"},{"default":i((()=>[o(J,{type:"selection",width:"55",align:"center"}),f(o(J,{prop:"deviceName",label:"设备名称","min-width":"100","show-overflow-tooltip":""},null,512),[[$,"deviceName"]]),f(o(J,{prop:"deviceKey",label:"设备KEY","show-overflow-tooltip":""},null,512),[[$,"deviceKey"]]),f(o(J,{prop:"deviceNumber",label:"设备编码","show-overflow-tooltip":""},null,512),[[$,"deviceNumber"]]),f(o(J,{prop:"deviceCategory",label:"设备类型","show-overflow-tooltip":""},null,512),[[$,"deviceCategory"]]),f(o(J,{prop:"installTime",label:"安装时间",width:"160",align:"center"},null,512),[[$,"installTime"]]),o(J,{label:"操作",width:"120",align:"center"},{"default":i((e=>[f((c(),m(q,{size:"small",text:"",type:"warning",onClick:l=>Y(e.row)},{"default":i((()=>[p("编辑")])),_:2},1032,["onClick"])),[[Z,"edit"]]),f((c(),m(q,{size:"small",text:"",type:"info",onClick:l=>{return a=e.row,void k.confirm('是否确认删除名称为："'+a.deviceName+'"的数据项?',"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{await h.dev_asset["delete"]({ids:a.id}),b.success("删除成功"),D()}));var a}},{"default":i((()=>[p("删除")])),_:2},1032,["onClick"])),[[Z,"del"]])])),_:1})])),_:1},8,["data"])),[[ee,s(E)]]),s(R).total?(c(),m(Q,{key:0,total:s(R).total,page:s(R).pageNum,"onUpdate:page":l[5]||(l[5]=e=>s(R).pageNum=e),limit:s(R).pageSize,"onUpdate:limit":l[6]||(l[6]=e=>s(R).pageSize=e),onPagination:l[7]||(l[7]=e=>s(D)())},null,8,["total","page","limit"])):y("",!0)])])),_:1})]),o(x,{ref_key:"editFormRef",ref:B,onGetList:l[8]||(l[8]=e=>s(D)(1))},null,512)])}}}),[["__scopeId","data-v-818662be"]]);export{K as default};