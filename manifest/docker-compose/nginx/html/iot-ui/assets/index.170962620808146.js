import e from"./editRole.1709626208081.js";import a from"./editPer.1709626208081.js";import l from"./permission.1709626208081.js";import{_ as t,b as o,h as s,E as i}from"./index.1709626208081.js";import{d as n,h as r,a1 as d,k as p,aa as u,R as m,S as f,ad as c,ah as h,ar as b,o as R,Y as y,W as w,T as D,j as _}from"./vue.1709626208081.js";var g=t(n({name:"apiV1SystemRoleList",components:{EditRole:e,permissionVue:l,EditPer:a},setup(){const{proxy:e}=_(),a=r(),l=r(),t=r(),n=r(),m=r(),f=d({deptData:[],tableData:{data:[],loading:!1,param:{name:"",status:-1}}}),h=()=>{b(),o.dept.getList({status:1}).then((e=>{f.deptData=e}))},b=()=>{f.tableData.loading=!0,o.role.getList(f.tableData.param).then((e=>{f.tableData.data=e||[]}))["finally"]((()=>f.tableData.loading=!1))};p((()=>{h()}));return{queryRef:l,resetQuery:()=>{l.value.resetFields(),h()},addRoleRef:a,editRoleRef:t,permissionRef:n,dataPermissionRef:m,dataPermission:async e=>{m.value.openDialog(e)},permission:async e=>{const{isAllow:a}=await o.role.auth.isAllow(e.id);a?n.value.openDialog(e):i.error("该角色禁止被授权")},onOpenAddRole:()=>{t.value.openDialog()},onOpenEditRole:e=>{t.value.openDialog(c(e))},onRowDel:a=>{s.confirm(`此操作将永久删除角色：“${a.name}”，是否继续?`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{o.role.deleteRole(a.id).then((()=>{i.success("删除成功"),e.$refs.editRoleRef.resetMenuSession(),b()}))}))},roleList:b,...u(f)}}}),[["render",function(e,a,l,t,o,s){const i=h("el-input"),n=h("el-form-item"),r=h("el-option"),d=h("el-select"),p=h("ele-Search"),u=h("el-icon"),c=h("el-button"),_=h("ele-Refresh"),g=h("ele-FolderAdd"),k=h("el-form"),C=h("el-table-column"),v=h("el-tag"),x=h("el-table"),V=h("EditRole"),L=h("permissionVue"),A=h("EditPer"),E=h("el-card"),P=b("auth"),j=b("col"),z=b("loading");return R(),m(E,{shadow:"nover","class":"page"},{"default":f((()=>[y(k,{model:e.tableData.param,inline:"",ref:"queryRef"},{"default":f((()=>[y(n,{label:"角色名称",prop:"name"},{"default":f((()=>[y(i,{modelValue:e.tableData.param.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.tableData.param.name=a),placeholder:"请输入角色名称","class":"w-50",clearable:""},null,8,["modelValue"])])),_:1}),y(n,{label:"状态",prop:"status"},{"default":f((()=>[y(d,{placeholder:"请选择状态",style:{width:"80px"},modelValue:e.tableData.param.status,"onUpdate:modelValue":a[1]||(a[1]=a=>e.tableData.param.status=a)},{"default":f((()=>[y(r,{label:"全部",value:-1}),y(r,{label:"启用",value:1}),y(r,{label:"禁用",value:0})])),_:1},8,["modelValue"])])),_:1}),y(n,null,{"default":f((()=>[y(c,{type:"primary",onClick:e.roleList},{"default":f((()=>[y(u,null,{"default":f((()=>[y(p)])),_:1}),w(" 查询 ")])),_:1},8,["onClick"]),y(c,{onClick:a[2]||(a[2]=a=>e.resetQuery())},{"default":f((()=>[y(u,null,{"default":f((()=>[y(_)])),_:1}),w(" 重置 ")])),_:1}),D((R(),m(c,{type:"primary",onClick:e.onOpenAddRole},{"default":f((()=>[y(u,null,{"default":f((()=>[y(g)])),_:1}),w(" 新增角色 ")])),_:1},8,["onClick"])),[[P,"add"]])])),_:1})])),_:1},8,["model"]),D((R(),m(x,{data:e.tableData.data,style:{width:"100%"},"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}},{"default":f((()=>[y(C,{type:"index",label:"序号",width:"60",align:"center"}),D(y(C,{prop:"name",label:"角色名称","show-overflow-tooltip":""},null,512),[[j,"name"]]),D(y(C,{prop:"remark",label:"角色描述","show-overflow-tooltip":""},null,512),[[j,"remark"]]),D(y(C,{prop:"listOrder",label:"排序",width:"60",align:"center"},null,512),[[j,"listOrder"]]),D((R(),m(C,{prop:"status",label:"角色状态",width:"100",align:"center"},{"default":f((e=>[1===e.row.status?(R(),m(v,{key:0,type:"success",size:"small"},{"default":f((()=>[w("启用")])),_:1})):(R(),m(v,{key:1,type:"info",size:"small"},{"default":f((()=>[w("禁用")])),_:1}))])),_:1})),[[j,"status"]]),D(y(C,{prop:"createdAt",label:"创建时间",width:"170",align:"center"},null,512),[[j,"createdAt"]]),D((R(),m(C,{label:"操作",width:"220",align:"center",fixed:"right"},{"default":f((a=>[D((R(),m(c,{size:"small",type:"text",onClick:l=>e.onOpenEditRole(a.row)},{"default":f((()=>[w("修改")])),_:2},1032,["onClick"])),[[P,"edit"]]),D((R(),m(c,{size:"small",text:"",type:"info",onClick:l=>e.onRowDel(a.row)},{"default":f((()=>[w("删除")])),_:2},1032,["onClick"])),[[P,"del"]]),D((R(),m(c,{size:"small",text:"",type:"success",onClick:l=>e.permission(a.row)},{"default":f((()=>[w("角色权限")])),_:2},1032,["onClick"])),[[P,"role-premission"]]),D((R(),m(c,{size:"small",text:"",type:"info",onClick:l=>e.dataPermission(a.row)},{"default":f((()=>[w("数据权限")])),_:2},1032,["onClick"])),[[P,"data-premission"]])])),_:1})),[[j,"handle"]])])),_:1},8,["data"])),[[z,e.tableData.loading]]),y(V,{ref:"editRoleRef",onGetList:e.roleList,list:e.tableData.data},null,8,["onGetList","list"]),y(L,{ref:"permissionRef"},null,512),y(A,{ref:"dataPermissionRef","dept-data":e.deptData},null,8,["dept-data"])])),_:1})}]]);export{g as default};