import e from"./list-form.1709626208081.js";import{b as t,E as a,r as l,h as n}from"./index.1709626208081.js";import{d as o,h as s,a as u,Y as d,S as i,F as r,ah as c,o as m,b as p,W as f}from"./vue.1709626208081.js";import"./validator.1709626208081.js";const v={"class":"p-3"},w=o({__name:"list",setup(o,{expose:w}){const h=s("列表权限"),_=s(!1),y=s([]),x=s(),b=s(),g=async()=>{y.value=[];let e=await t.menu.list.getList({menuId:x.value.id,status:-1});y.value=e||[]},C=async e=>{const[n,o]=e.split("-"),s={parentId:-1,menuId:x.value.id,name:o,code:n,description:"",status:1};await t.menu.list.add(s),a.success("操作成功"),g(),l()},k=()=>{b.value.open({menuId:x.value.id})};return w({open:async e=>{h.value="列表权限 - "+e.title,_.value=!0,x.value=e,g()}}),(o,s)=>{const w=c("ele-FolderAdd"),x=c("el-icon"),V=c("el-button"),I=c("ele-Plus"),j=c("el-dropdown-item"),B=c("el-dropdown-menu"),T=c("el-dropdown"),z=c("el-table-column"),F=c("el-switch"),U=c("el-table"),A=c("el-drawer");return m(),u(r,null,[d(A,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=e=>_.value=e),title:h.value,direction:"rtl",size:"700px"},{"default":i((()=>[p("div",v,[d(V,{type:"success","class":"mr-3",onClick:k},{"default":i((()=>[d(x,null,{"default":i((()=>[d(w)])),_:1}),f(" 新增列 ")])),_:1}),d(T,{onCommand:C},{dropdown:i((()=>[d(B,null,{"default":i((()=>[d(j,{command:"status-状态"},{"default":i((()=>[f("状态")])),_:1}),d(j,{command:"createdAt-创建时间"},{"default":i((()=>[f("创建时间")])),_:1}),d(j,{command:"handle-操作"},{"default":i((()=>[f("操作")])),_:1}),d(j,{command:"selection-复选框"},{"default":i((()=>[f("复选框")])),_:1})])),_:1})])),"default":i((()=>[d(V,{text:"",type:"primary"},{"default":i((()=>[d(x,null,{"default":i((()=>[d(I)])),_:1}),f("常用列表权限 ")])),_:1})])),_:1})]),d(U,{data:y.value,style:{width:"100%"},"row-key":"id",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}},{"default":i((()=>[d(z,{type:"index",label:"序号",width:"60",align:"center"}),d(z,{prop:"name",label:"字段名称",width:"220","show-overflow-tooltip":""}),d(z,{prop:"code",label:"字段key","show-overflow-tooltip":""}),d(z,{prop:"status",label:"状态",width:"100",align:"center"},{"default":i((e=>[d(F,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启","inactive-text":"禁",onChange:o=>(e=>{let o=1===e.status?"启用":"停用";n.confirm('确认要"'+o+'"："'+e.name+'"字段吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async function(){await t.menu.list.setStatus(e.id,e.menuId,e.status),a.success("操作成功"),l()}))["catch"]((function(){e.status=0===e.status?1:0}))})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),d(z,{label:"操作",width:"100",align:"center"},{"default":i((e=>[d(V,{size:"small",text:"",type:"warning",onClick:t=>{return a=e.row,void b.value.open(a);var a}},{"default":i((()=>[f("修改")])),_:2},1032,["onClick"]),d(V,{size:"small",text:"",type:"danger",onClick:o=>{return s=e.row,void n.confirm(`此操作将删除字段：“${s.name}”，是否继续?`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{await t.menu.list.del(s.id),a.success("删除成功"),g(),l()}));var s}},{"default":i((()=>[f("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue","title"]),d(e,{ref_key:"listFormRef",ref:b,onGetList:g},null,512)],64)}}});export{w as default};