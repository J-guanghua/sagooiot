import{d as a,h as e,a1 as t,k as l,aa as o,a as n,Y as s,S as i,j as u,e as r,ah as d,ar as p,o as c,a8 as m,F as b,a7 as f,R as g,W as h,T as D,X as y,Z as _}from"./vue.1709626208081.js";import j from"./editConfig.17096262080812.js";import{_ as w,b as k,E as v,h as C}from"./index.1709626208081.js";const x=a({name:"apiV1SystemDictDataList",components:{EditConfig:j},setup(){const{proxy:a}=u(),n=e(),s=e(),i=e(),{sys_yes_no:d,sys_job_group:p}=a.useDict("sys_yes_no","sys_job_group"),c=t({ids:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,jobName:"",jobGroup:"",status:null}}}),m=()=>{c.tableData.loading=!0,k.task.getList(c.tableData.param).then((a=>{c.tableData.data=a.list,c.tableData.total=a.total}))["finally"]((()=>c.tableData.loading=!1))};l((()=>{m()}));return{addDicRef:n,editDicRef:s,queryRef:i,sys_yes_no:d,sys_job_group:p,onOpenAddDic:()=>{s.value.openDialog()},onOpenEditDic:a=>{s.value.openDialog(a)},onRowDel:a=>{let e="你确定要删除所选数据？",t=[];a?(e=`此操作将永久删除任务名称：“${a.jobName}”，是否继续?`,t=[a.jobId]):t=c.ids,0!==t.length?C.confirm(e,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{k.task.del(t).then((()=>{v.success("删除成功"),m()}))}))["catch"]((()=>{})):v.error("请选择要删除的数据。")},onRowRun:a=>{C.confirm("是否确认立即执行一次该任务?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{k.task.run(a.jobId).then((()=>{v.success("操作成功"),m()}))}))},handleStatusChange:a=>{let e=0===a.status?"启用":"停用";C.confirm('确认要"'+e+'"："'+a.jobName+'"任务吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return 0===a.status?k.task.start(a.jobId):k.task.stop(a.jobId)})).then((()=>{v.success(e+"成功")}))["catch"]((function(){a.status=0===a.status?1:0}))},dataList:m,resetQuery:a=>{a&&(a.resetFields(),m())},handleSelectionChange:a=>{c.ids=a.map((a=>a.jobId))},jobGroupFormat:e=>a.selectDictLabel(r(p),e.jobGroup),...o(c)}}}),V={"class":"page"};var R=w(x,[["render",function(a,e,t,l,o,u){const r=d("el-input"),j=d("el-form-item"),w=d("el-option"),k=d("el-select"),v=d("ele-Search"),C=d("el-icon"),x=d("el-button"),R=d("ele-FolderAdd"),S=d("ele-Delete"),N=d("el-form"),L=d("el-table-column"),G=d("el-switch"),T=d("el-table"),I=d("pagination"),E=d("el-card"),U=d("EditConfig"),z=p("auth"),B=p("col"),F=p("noauth"),O=p("loading");return c(),n("div",V,[s(E,{shadow:"nover"},{"default":i((()=>[s(N,{model:a.tableData.param,ref:"queryRef",inline:""},{"default":i((()=>[s(j,{label:"任务名称",prop:"jobName"},{"default":i((()=>[s(r,{modelValue:a.tableData.param.jobName,"onUpdate:modelValue":e[0]||(e[0]=e=>a.tableData.param.jobName=e),placeholder:"请输入",clearable:"",style:{width:"150px"},onKeyup:m(a.dataList,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),s(j,{label:"任务组名",prop:"jobGroup"},{"default":i((()=>[s(k,{modelValue:a.tableData.param.jobGroup,"onUpdate:modelValue":e[1]||(e[1]=e=>a.tableData.param.jobGroup=e),placeholder:"请选择",style:{width:"150px"}},{"default":i((()=>[(c(!0),n(b,null,f(a.sys_job_group,(a=>(c(),g(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(j,{label:"任务状态",prop:"status"},{"default":i((()=>[s(k,{modelValue:a.tableData.param.status,"onUpdate:modelValue":e[2]||(e[2]=e=>a.tableData.param.status=e),style:{width:"100px"},placeholder:"请选择"},{"default":i((()=>[s(w,{label:"启用",value:0}),s(w,{label:"禁用",value:1})])),_:1},8,["modelValue"])])),_:1}),s(j,null,{"default":i((()=>[s(x,{type:"primary","class":"ml10",onClick:a.dataList},{"default":i((()=>[s(C,null,{"default":i((()=>[s(v)])),_:1}),h(" 查询 ")])),_:1},8,["onClick"]),D((c(),g(x,{type:"primary","class":"ml10",onClick:a.onOpenAddDic},{"default":i((()=>[s(C,null,{"default":i((()=>[s(R)])),_:1}),h(" 新增任务 ")])),_:1},8,["onClick"])),[[z,"add"]]),D((c(),g(x,{type:"info","class":"ml10",onClick:e[3]||(e[3]=e=>a.onRowDel(null))},{"default":i((()=>[s(C,null,{"default":i((()=>[s(S)])),_:1}),h(" 删除任务 ")])),_:1})),[[z,"del"]])])),_:1})])),_:1},8,["model"]),D((c(),g(T,{data:a.tableData.data,style:{width:"100%"},onSelectionChange:a.handleSelectionChange},{"default":i((()=>[s(L,{type:"selection",width:"55",align:"center"}),D(s(L,{label:"ID",align:"center",prop:"jobId",width:"100"},null,512),[[B,"jobId"]]),D(s(L,{label:"任务名称",prop:"jobName","show-overflow-tooltip":""},null,512),[[B,"jobName"]]),D(s(L,{label:"任务描述",prop:"remark","show-overflow-tooltip":""},null,512),[[B,"remark"]]),D(s(L,{label:"任务分组",prop:"jobGroup",width:"120",formatter:a.jobGroupFormat},null,8,["formatter"]),[[B,"jobGroup"]]),D(s(L,{label:"任务方法名",prop:"invokeTarget"},null,512),[[B,"invokeTarget"]]),D(s(L,{label:"cron执行表达式",prop:"cronExpression"},null,512),[[B,"cronExpression"]]),D((c(),g(L,{label:"状态",align:"center",prop:"status",width:"100"},{"default":i((e=>[D(s(G,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"inline-prompt":"","active-value":0,"inactive-value":1,"active-text":"启","inactive-text":"禁",onChange:t=>a.handleStatusChange(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"]),[[z,"status"]]),D((c(),n("span",null,[h(y(e.row.status?"正常":"暂停"),1)])),[[F,"status"]])])),_:1})),[[B,"status"]]),D((c(),g(L,{label:"操作",width:"180",align:"center",fixed:"right"},{"default":i((e=>[D((c(),g(x,{size:"small",text:"",type:"warning",onClick:t=>a.onOpenEditDic(e.row)},{"default":i((()=>[h("修改")])),_:2},1032,["onClick"])),[[z,"edit"]]),D((c(),g(x,{size:"small",text:"",type:"info",onClick:t=>a.onRowDel(e.row)},{"default":i((()=>[h("删除")])),_:2},1032,["onClick"])),[[z,"del"]]),D((c(),g(x,{size:"small",text:"",type:"primary",onClick:t=>a.onRowRun(e.row)},{"default":i((()=>[h("执行一次")])),_:2},1032,["onClick"])),[[z,"do"]])])),_:1})),[[B,"handle"]])])),_:1},8,["data","onSelectionChange"])),[[O,a.tableData.loading]]),D(s(I,{total:a.tableData.total,page:a.tableData.param.pageNum,"onUpdate:page":e[4]||(e[4]=e=>a.tableData.param.pageNum=e),limit:a.tableData.param.pageSize,"onUpdate:limit":e[5]||(e[5]=e=>a.tableData.param.pageSize=e),onPagination:a.dataList},null,8,["total","page","limit","onPagination"]),[[_,a.tableData.total>0]])])),_:1}),s(U,{ref:"editDicRef",onDataList:a.dataList},null,8,["onDataList"])])}]]);export{R as default};